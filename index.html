<!DOCTYPE html>
<html lang="ja" class="notranslate">
<head>
    <meta charset="UTF-8">
    <title>営業管理</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body { font-family: 'Hiragino Sans', sans-serif; background-color: #f0f4f8; padding: 0; margin: 0; color: #333; }
        #pw_screen { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #1a202c; display: flex; justify-content: center; align-items: center; z-index: 10000; }
        #pw_box { background: white; padding: 40px; border-radius: 12px; text-align: center; box-shadow: 0 10px 25px rgba(0,0,0,0.5); }
        #main_content { display: none; }
        .nav-bar { background: #2d3748; display: flex; align-items: center; position: sticky; top: 0; z-index: 1000; height: 60px; }
        .nav-item { padding: 0 25px; height: 60px; line-height: 60px; color: #a0aec0; cursor: pointer; font-weight: bold; border-bottom: 3px solid transparent; }
        .nav-item.active { color: white; border-bottom: 3px solid #3182ce; background: rgba(255,255,255,0.05); }
        #sync_status { font-size: 12px; color: #cbd5e0; margin-left: auto; padding-right: 20px; }
        .container { padding: 20px; }
        .card { background: white; padding: 25px; border-radius: 12px; box-shadow: 0 4px 20px rgba(0,0,0,0.08); overflow-x: auto; margin-bottom: 25px; }
        
        /* --- 実績管理セクション：一切の変更を禁止（完全固定） --- */
        table { border-collapse: collapse; background: white; border: 4px solid black !important; font-size: 1.1rem; width: max-content; table-layout: fixed; }
        th, td { border: 4px solid black; padding: 12px 6px; overflow: hidden; box-sizing: border-box; }
        th { background: #edf2f7; }
        
        tr.bb-2px td:not(.cat-header) { border-bottom: 2px solid black !important; }
        tr.bt-2px td:not(.cat-header) { border-top: 2px solid black !important; }
        tr.bb-3px td:not(.cat-header) { border-bottom: 3px solid black !important; }
        tr.bt-3px td:not(.cat-header) { border-top: 3px solid black !important; }
        tr.bb-4px td { border-bottom: 4px solid black !important; }

        .br-3px { border-right: 3px solid black !important; }
        .bl-3px { border-left: 3px solid black !important; }

        .col-item { width: 180px; }
        .col-type { width: 100px; }
        .col-month { width: 120px; }
        .col-total { width: 140px; background: #fffaf0 !important; font-weight: bold; }

        .cat-header { background: #ebf8ff !important; font-weight: bold; text-align: center; }
        .text-right { text-align: right !important; padding-right: 12px !important; }
        .text-center { text-align: center !important; }

        .sticky-left { position: sticky; left: 0; z-index: 30; background: #ebf8ff !important; border-right: 4px solid black !important; }
        .sticky-left-2 { position: sticky; left: 180px; z-index: 30; background: white !important; border-left: 4px solid black !important; border-right: 4px solid black !important; }

        /* 営業推進管理表用：列幅調整（全体的に横に広げ、余白を埋める） */
        .sales-raw-table { width: 100%; min-width: 2000px; } /* 表の全幅を設定 */
        .sales-raw-table th, .sales-raw-table td { width: 130px; } /* 各セルの基準幅を拡大 */
        .col-sales-aff { width: 150px !important; }
        .col-sales-name { width: 220px !important; }
        .col-sales-info { width: 150px !important; }
        .col-sales-total { width: 160px !important; background: #fffaf0 !important; font-weight: bold; }

        .sales-raw-table th { background: #edf2f7; font-weight: bold; }

        .charts-container { display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 20px; }
        .chart-box { background: white; padding: 20px; border-radius: 12px; height: 350px; }
    </style>
</head>
<body>
<div id="pw_screen"><div id="pw_box">
    <h2 style="margin:0 0 20px 0;">営業管理</h2>
    <input type="password" id="pass_val" style="padding:12px; width:220px;" onkeydown="if(event.keyCode==13)checkPW()"><br><br>
    <button onclick="checkPW()" style="padding:12px 35px; background:#3182ce; color:white; border:none; border-radius:6px; cursor:pointer; font-weight:bold;">ログイン</button>
    <p id="err_msg" style="color:red; display:none;">パスワードが違います</p>
</div></div>
<div id="main_content">
    <div class="nav-bar">
        <div class="nav-item active" id="tab-perf" onclick="switchTab('perf')">実績管理</div>
        <div class="nav-item" id="tab-sales" onclick="switchTab('sales')">営業推進管理表</div>
        <div id="sync_status">データ同期中...</div>
    </div>
    <div class="container">
        <div id="section-perf">
            <div class="card">
                <div style="display:flex; align-items:center; margin-bottom:20px;">
                    <h2 style="margin:0; border-left:5px solid #3182ce; padding-left:15px; margin-right: 25px;">拠点別実績・予算</h2>
                    <select id="region-select" style="padding:10px 20px; border-radius:6px; font-size:1.1rem; cursor:pointer;" onchange="renderPerf()">
                        <option value="全体合計">全国合計</option><option value="東海">東海</option><option value="首都圏">首都圏</option><option value="東日本">東日本</option><option value="西日本">西日本</option>
                    </select>
                </div>
                <table class="perf-table">
                    <thead>
                        <tr>
                            <th rowspan="2" class="col-item sticky-left">項目</th><th rowspan="2" class="col-type sticky-left-2">区分</th>
                            <th colspan="6">上期実績</th><th class="col-total">上期計</th>
                            <th colspan="6">下期実績</th><th class="col-total">下期計</th>
                            <th class="col-total">年間計</th>
                        </tr>
                        <tr>
                            <th class="col-month br-3px">6月</th><th class="col-month bl-3px br-3px">7月</th><th class="col-month bl-3px br-3px">8月</th><th class="col-month bl-3px br-3px">9月</th><th class="col-month bl-3px br-3px">10月</th><th class="col-month bl-3px">11月</th><th class="col-total">計</th>
                            <th class="col-month br-3px">12月</th><th class="col-month bl-3px br-3px">1月</th><th class="col-month bl-3px br-3px">2月</th><th class="col-month bl-3px br-3px">3月</th><th class="col-month bl-3px br-3px">4月</th><th class="col-month bl-3px">5月</th><th class="col-total">計</th>
                            <th class="col-total







